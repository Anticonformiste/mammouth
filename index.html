


<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <title>Mammouth</title>
  <link rel="stylesheet" type="text/css" href="stylesheets/docs.css" />
  <link rel="stylesheet" type="text/css" href="stylesheets/idle.css" />
</head>
<body>

  <div id="fadeout"></div>

  <div id="flybar">
    <a id="logo" href="#top"><img src="documentation/images/logo.png" width="225" height="39" alt="CoffeeScript" /></a>
    <div class="navigation toc">
      <div class="button">
        Table of Contents
      </div>
      <div class="contents menu">
        <a href="#overview">Overview</a>
        <a href="#installation">Installation</a>
        <a href="#usage">Usage</a>
        <a href="#literate">Literate CoffeeScript</a>
        <a href="#language">Language Reference</a>
        <a href="#literals">Literals: Functions, Objects and Arrays</a>
        <a href="#lexical-scope">Lexical Scoping and Variable Safety</a>
        <a href="#conditionals">If, Else, Unless, and Conditional Assignment</a>
        <a href="#splats">Splats...</a>
        <a href="#loops">Loops and Comprehensions</a>
        <a href="#slices">Array Slicing and Splicing</a>
        <a href="#expressions">Everything is an Expression</a>
        <a href="#operators">Operators and Aliases</a>
        <a href="#classes">Classes, Inheritance, and Super</a>
        <a href="#destructuring">Destructuring Assignment</a>
        <a href="#fat-arrow">Function Binding</a>
        <a href="#embedded">Embedded JavaScript</a>
        <a href="#switch">Switch and Try/Catch</a>
        <a href="#comparisons">Chained Comparisons</a>
        <a href="#strings">String Interpolation, Block Strings, and Block Comments</a>
        <a href="#regexes">Block Regular Expressions</a>
        <a href="#cake">Cake, and Cakefiles</a>
        <a href="#source-maps">Source Maps</a>
        <a href="#scripts">"text/coffeescript" Script Tags</a>
        <a href="#resources">Books, Screencasts, Examples and Resources</a>
        <a href="#changelog">Change Log</a>
      </div>
    </div>
    <div class="navigation try">
      <div class="button">
        Try Mammouth
        <div class="repl_bridge"></div>
      </div>
      <div class="contents repl_wrapper">
        <div class="code">
          <div class="screenshadow tl"></div>
          <div class="screenshadow tr"></div>
          <div class="screenshadow bl"></div>
          <div class="screenshadow br"></div>
          <div id="repl_source_wrap">
            <textarea id="repl_source" rows="100" spellcheck="false">
{{
hello = 'Hello Mammouth'
echo(hello)
}}</textarea>
          </div>
          <div id="repl_results_wrap"><pre id="repl_results"></pre></div>
          <div class="minibutton dark run permalink" id="repl_permalink">Link</div>
          <br class="clear" />
        </div>
      </div>
    </div>
    <div class="navigation annotated">
      <div class="button">
        Annotated Source
      </div>
      <div class="contents menu">
        <a href="documentation/docs/grammar.html">Grammar Rules &mdash; src/grammar</a>
        <a href="documentation/docs/lexer.html">Lexing Tokens &mdash; src/lexer</a>
        <a href="documentation/docs/rewriter.html">The Rewriter &mdash; src/rewriter</a>
        <a href="documentation/docs/nodes.html">The Syntax Tree &mdash; src/nodes</a>
        <a href="documentation/docs/scope.html">Lexical Scope &mdash; src/scope</a>
        <a href="documentation/docs/helpers.html">Helpers &amp; Utility Functions &mdash; src/helpers</a>
        <a href="documentation/docs/coffee-script.html">The CoffeeScript Module &mdash; src/coffee-script</a>
        <a href="documentation/docs/cake.html">Cake &amp; Cakefiles &mdash; src/cake</a>
        <a href="documentation/docs/command.html">"coffee" Command-Line Utility &mdash; src/command</a>
        <a href="documentation/docs/optparse.html">Option Parsing &mdash; src/optparse</a>
        <a href="documentation/docs/repl.html">Interactive REPL &mdash; src/repl</a>
        <a href="documentation/docs/sourcemap.html">Source Maps &mdash; src/sourcemap</a>
      </div>
    </div>
    <div id="error" style="display:none;"></div>
  </div>

  <div class="container">
    <span class="bookmark" id="top"></span>

    <p>
      <b>Mammouth is a small language that compiles into PHP</b>, inspired by CoffeeScript. It's compiled to PHP codes/files that you can run in your PHP server.
    </p>

    <p>
      <b>Latest Version:</b>
      <a href="https://github.com/btwael/mammouth/archive/v0.1.1.zip">0.1.1</a>
    </p>

    <pre>
sudo npm install -g mammouth</pre>

    <h2>
      <span id="overview" class="bookmark"></span>
      Overview
    </h2>

    <p><i>Mammouth on the left, compiled PHP output on the right.</i></p>

    <div class='code'><pre class="idle">
{{
number   <span class="Keyword">=</span> 42
opposite <span class="Keyword">=</span> <span class="BuiltInConstant">true</span>

<span class="FunctionName">square</span> <span class="Keyword">=</span> <span class="FunctionArgument">(x)</span> <span class="Keyword">-></span>
 <span class="Keyword">return</span>(x <span class="Keyword">*</span> x)

list <span class="Keyword">=</span> [1, 2, 3, 4, 5]

<span class="Keyword">if</span> elvis
 alert(<span class="String">"I knew it!"</span>) 

<span class="FunctionName">Hello</span> <span class="Keyword">=</span> <span class="Keyword">-></span>
 echo(<span class="String">'Hello Mammouth'</span>)
}}
</pre><pre class="idle">
&lt;?php 
$number <span class="Keyword">=</span> 42;
$opposite <span class="Keyword">=</span> true;

<span class="Keyword">function</span> <span class="FunctionName">square</span>(<span class="FunctionArgument">$x</span>) { 
  <span class="Keyword">return</span>($x <span class="Keyword">*</span> $x);
};
$list <span class="Keyword">=</span> array(1, 2, 3, 4, 5);

<span class="Keyword">if</span>($elvis) {  
  alert(<span class="String">'I knew it!'</span>);
}
<span class="Keyword">function</span> <span class="FunctionName">Hello</span>() {  
  echo(<span class="String">'Hello Mammouth'</span>);
};
?&gt;
</pre><br class='clear' /></div>

    <h2>
      <span id="installation" class="bookmark"></span>
      Installation
    </h2>

    <p>
      The Mammouth compiler is written in JavaScript,
      using the <a href="http://pegjs.majda.cz/">PEG.js</a>. The
      command-line version of <tt>mammouth</tt> is available as a
      <a href="http://nodejs.org/">Node.js</a> utility. The
      <a href="extras/mammouth.js">core compiler</a> however, does not
      depend on Node, and can be run in any JavaScript environment, or in the
      browser (see "Try Mammouth", above).
    </p>

    <p>
      To install, first make sure you have a working copy of the latest stable version of
      <a href="http://nodejs.org/">Node.js</a>, and <a href="http://npmjs.org">npm</a>
      (the Node Package Manager). You can then install Mammouth with npm:
    </p>

    <pre>
npm install -g Mammouth</pre>

    <p>
      (Leave off the <tt>-g</tt> if you don't wish to install globally.)
    </p>

    <p>
      If you'd prefer to install the latest <b>master</b> version of Mammouth, you
      can clone the Mammouth
      <a href="http://github.com/btwael/mammouth">source repository</a>
      from GitHub, or download
      <a href="http://github.com/btwael/mammouth/tarball/master">the source</a> directly.
      To install the lastest master Mammouth compiler with npm:
    </p>

<pre>
npm install -g http://github.com/btwael/mammouth/tarball/master</pre>

    <h2>
      <span id="usage" class="bookmark"></span>
      Usage
    </h2>

    <p>
      Once installed, you should have access to the <tt>mammouth</tt> command,
      which can execute scripts, compile <tt>.mammouth</tt> files into <tt>.php</tt>,
      and provide an interactive REPL. The <tt>mammouth</tt> command takes the
      following options:
    </p>

    <table>
      <tr>
        <td><code>-c, --compile</code></td>
        <td>
          Compile a <tt>.mammouth</tt> script into a <tt>.php</tt> PHP file
          of the same name.
        </td>
      </tr>
      <tr>
        <td><code>-o, --output [DIR]</code></td>
        <td>
          Write out all compiled PHP files into the specified directory.
          Use in conjunction with <tt>--compile</tt>.
        </td>
      </tr>
    </table>

    <p>
      <b>Examples:</b>
    </p>

    <ul>
      <li>
        Compile <tt>codes.mammouth</tt> to <tt>codes.php</tt> in the same folder<br />
        <tt>coffee --compile --output lib/ src/</tt>
      </li>
      <li>
        Compile all mammouth files in <tt>/codes</tt> folder to <tt>/result</tt> folder<br />
        <tt>mammouth --compile --output /result /codes</tt>
      </li>
    </ul>

    <h2>
      <span id="language" class="bookmark"></span>
      Language Reference
    </h2>

    <p>
      <i>
        This reference is structured so that it can be read from top to bottom,
        if you like. Later sections use ideas and syntax previously introduced.
        Familiarity with JavaScript is assumed.
        In all of the following examples, the source Mammouth is provided on
        the left, and the direct compilation into PHP is on the right.
      </i>
    </p>

    <p>
      First, the basics: Mammouth uses significant whitespace to delimit blocks of code.
      You don't need to use semicolons <tt>;</tt> to terminate expressions,
      ending the line will do just as well (although semicolons can still
      be used to fit multiple expressions onto a single line).
      Instead of using curly braces
      <tt>{ }</tt> to surround blocks of code in <a href="#literals">functions</a>,
      <a href="#conditionals">if-statements</a> and
      <a href="#switch">switch</a>,
      use indentation.
    </p>

    <p>
      <span id="literals" class="bookmark"></span>
      <b class="header">Functions</b>
      Functions are defined by an optional list of parameters in parentheses,
      an arrow, and the function body. The empty function looks like this:
      <tt>-></tt>
    </p>
    <div class='code'><pre class="idle">
{{
<span class="FunctionName">square</span> <span class="Keyword">=</span> <span class="FunctionArgument">(x)</span> <span class="Keyword">-></span>
 <span class="Keyword">return</span>(x <span class="Keyword">*</span> x)

<span class="FunctionName">cube</span> <span class="">=</span> <span class="FunctionArgument">(x)</span> <span class="Keyword">-></span>
 <span class="Keyword">return</span>(square(x) <span class="Keyword">*</span> x)
}}
</pre><pre class="idle">
&lt;?php
<span class="Keyword">function</span> <span class="FunctionName">square</span>(<span class="FunctionArgument">$x</span>) { 
  <span class="Keyword">return</span>($x * $x);
};
<span class="Keyword">function</span> <span class="FunctionName">cube</span>(<span class="FunctionArgument">$x</span>) { 
  <span class="Keyword">return</span>(square($x) * $x);
};
?&gt;
</pre><br class='clear' /></div>

    <p>
      Functions may also have default values for arguments.
    </p>

    <div class='code'><pre class="idle">
{{
<span class="FunctionName">Say</span> <span class="Keyword">=</span> <span class="FunctionArgument">(text = <span class="String">"Hello World!"</span>)</span> <span class="Keyword">-></span>
 echo(text)
}}
</pre><pre class="idle">
&lt;?php
<span class="Keyword">function</span> <span class="FunctionName">Say</span>(<span class="FunctionArgument">$x = "Hello World!"</span>) { 
  echo($text);
};
?&gt;
</pre><br class='clear' /></div>

    <p>
      You can pass a variable by reference to a function so the function can modify the variable. The syntax is as follows: (<tt>a</tt> get 6 at the end)
    </p>

    <div class='code'><pre class="idle">
{{
<span class="FunctionName">foo</span> <span class="Keyword">=</span> <span class="FunctionArgument">(&var)</span> <span class="Keyword">-></span>
 var++
a <span class="Keyword">=</span> 5
foo(a)
}}
</pre><pre class="idle">
&lt;?php
<span class="Keyword">function</span> <span class="FunctionName">foo</span>(<span class="FunctionArgument">&$var</span>) { 
  $var++;
};
a <span class="Keyword">=</span> 5;
foo(a);
?&gt;
</pre><br class='clear' /></div>

    <p>
      <span id="arrays" class="bookmark"></span>
      <b class="header">Arrays</b>
      The Mammouth literals for arrays look very similar to their JavaScript cousins.
    </p>
    <div class='code'><pre class="idle">
{{
song <span class="Keyword">=</span> [<span class="String">"do"</span>, <span class="String">"re"</span>, <span class="String">"mi"</span>, <span class="String">"fa"</span>, <span class="String">"so"</span>]
}}
</pre><pre class="idle">
&lt;?php
$song <span class="Keyword">=</span> array(<span class="String">'do'</span>, <span class="String">'re'</span>, <span class="String">'mi'</span>, <span class="String">'fa'</span>, <span class="String">'so'</span>);
?&gt;
</pre><br class='clear' /></div>

    <p>
      <span id="If" class="bookmark"></span>
      <b class="header">If/else</b>
      If/else statements can be written without the use of parentheses and curly brackets. As with functions and other block expressions, conditionals are delimited by indentation.
    </p>
    <div class='code'><pre class="idle">
{{
<span class="Keyword">if</span> happy <span class="Keyword">and</span> knowsIt
  clapsHands()
  chaChaCha()
<span class="Keyword">else</span>
  showIt()
}}
</pre><pre class="idle">
&lt;?php
<span class="Keyword">if</span>($happy <span class="Keyword">&&</span> $knowsIt) {  
  clapsHands();
  chaChaCha();
} <span class="Keyword">else</span> {  
  showIt();
}
?&gt;
</pre><br class='clear' /></div>

    <p>
      <span id="for" class="bookmark"></span>
      <b class="header">For Loops</b>
      For statements can be written without the use of parentheses and curly brackets. As with functions and other block expressions. There are two examples of <tt>For</tt> usage:
    </p>
    <div class='code'><pre class="idle">
{{
<span class="Keyword">for</span> i <span class="Keyword">=</span> 0; i <span class="Keyword">&gt;</span> 10; i<span class="Keyword">++</span>
  echo(i)

<span class="Keyword">for</span> contat <span class="Keyword">of</span> contacts
  echo(contacts)
}}
</pre><pre class="idle">
&lt;?php
<span class="Keyword">for</span>($i <span class="Keyword">=</span> 0; $i <span class="Keyword">&lt;</span> 10; $i<span class="Keyword">++</span>) {  
  echo($i);
}
<span class="Keyword">for</span>($_i <span class="Keyword">=</span> 0; $contat <span class="Keyword">&gt;</span> count($contacts); $contat<span class="Keyword">++</span>) { 
  $contat <span class="Keyword">=</span> $contacts[$_i];
  echo($contacts);
}
?&gt;
</pre><br class='clear' /></div>

    <p>
      <span id="operetor" class="bookmark"></span>
      <b class="header">Operators and Aliases</b>
      For logic, <tt>and</tt> compiles to <tt>&&</tt>, <tt>and</tt> or into <tt>||</tt>. 
    </p>
    <p>
      Instead of a newline or semicolon, <tt>then</tt> can be used to separate conditions from expressions, in if/else and switch/when statements. 
    </p>
    <p>
      All other PHP operators are supported by Mammouth like <tt>+=</tt>, <tt>?+</tt>, <tt>>>>=</tt>, <tt>^</tt>, <tt>~</tt>...
    </p>

    <p>
      <span id="classes" class="bookmark"></span>
      <b class="header">Classes</b>
      Classes are not by Mammouth yet :(, we will add it soon :)
    </p>

    <p>
      <span id="heredoc" class="bookmark"></span>
      <b class="header">Heredoc strings</b>
      You can use a multi-line string using the syntax of mammouth heredoc.
    </p>
    <div class='code'><pre class="idle">
{{
str <span class="Keyword">=</span> <span class="String">`Example of string
spanning multiple lines
using heredoc syntax.`</span>

echo(<span class="String">`My name is "$name". I am printing some $foo->foo.
Now, I am printing some {$foo->bar[1]}.
This should print a capital 'A': \x41`</span>)
}}
</pre><pre class="idle">
&lt;?php
$str <span class="Keyword">=</span> <span class="Keyword">&lt;&lt;&lt;EOD</span>
<span class="String">Example of string
spanning multiple lines
using heredoc syntax.</span>
<span class="Keyword">EOD</span>;

echo(<span class="Keyword">&lt;&lt;&lt;EOT</span>
<span class="String">My name is "$name". I am printing some $foo->foo.
Now, I am printing some {$foo->bar[1]}.
This should print a capital 'A': \x41</span>
<span class="Keyword">EOT</span>);
?&gt;
</pre><br class='clear' /></div>

    <p>
      <span id="switch" class="bookmark"></span>
      <b class="header">Switch/Case/Else</b>
      Switch statements in PHP are a bit awkward. You need to remember to break at the end of every case statement to avoid accidentally falling through to the default case. The format is: <tt>switch</tt> condition, <tt>case</tt> clauses, <tt>else</tt> the default case. 
    </p>
    <div class='code'><pre class="idle">
{{
<span class="Keyword">switch</span> day
  <span class="Keyword">case</span> <span class="String">"Mon"</span> <span class="Keyword">then</span>
    go(work)
  <span class="Keyword">case</span> <span class="String">"Tue"</span> <span class="Keyword">then</span>
    go(relax)
  <span class="Keyword">case</span> <span class="String">"Thu"</span>
    go(iceFishing)
  <span class="Keyword">case</span> <span class="String">"Fri"</span>
    if day == bingoDay
      go(bingo)
      go(dancing)
  <span class="Keyword">case</span> <span class="String">"Sun"</span> <span class="Keyword">then</span>
    go(church)
  <span class="Keyword">else</span>
    go(work)
}}
</pre><pre class="idle">
&lt;?php
<span class="Keyword">switch</span>($day) {
  <span class="Keyword">case</span> 'Mon': 
    go($work);
    <span class="Keyword">break</span>;
  <span class="Keyword">case</span> 'Tue': 
    go($relax);
    <span class="Keyword">break</span>;
  <span class="Keyword">case</span> 'Thu': 
    go($iceFishing);
    <span class="Keyword">break</span>;
  <span class="Keyword">case</span> 'Fri': 
    if($day == $bingoDay) { 
      go($bingo);
      go($dancing);
    }
    <span class="Keyword">break</span>;
  <span class="Keyword">case</span> 'Sun': 
    go($church);
    <span class="Keyword">break</span>;
  <span class="Keyword">default</span>:  
    go($work);
}
?&gt;
</pre><br class='clear' /></div>

    <h2>
      Resources
    </h2>

    <ul>
      <li>
        <a href="https://github.com/btwael/mammouth">Source Code</a><br />
      </li>
    </ul>

    <h2>
      <span id="changelog" class="bookmark"></span>
      Change Log
    </h2>

    <p>
      <b class="header" style="margin-top: 20px;">0.1.1
        <span class="timestamp"> &ndash; <small>Jul 13, 2013</small></span>
      </b>
      Fix <tt>For</tt> loops.
    </p>

    <p>
      <b class="header" style="margin-top: 20px;">0.1.0
        <span class="timestamp"> &ndash; <small>Jul 12, 2013</small></span>
      </b>
      Initial Mammouth release.
    </p>

  </div>

  <script type="text/coffeescript">
    sourceFragment = "try:"

    # Set up the compilation function, to run when you stop typing.
    compileSource = ->
      source = $('#repl_source').val()
      window.compiledJS = ''
      try
        window.compiledJS = mammouth.compile source
        el = $('#repl_results')[0]
        if el.innerText
          el.innerText = window.compiledJS
        else
          $(el).text window.compiledJS
        $('#error').hide()
      catch {location, message}
        if location?
          message = "Error on line #{location.first_line + 1}: #{message}"
        $('#error').text(message).show()

      # Update permalink
      $('#repl_permalink').attr 'href', "##{sourceFragment}#{encodeURIComponent source}"

    # Listen for keypresses and recompile.
    $('#repl_source').keyup -> compileSource()

    # Eval the compiled js.
    evalJS = ->
      try
        eval window.compiledJS
      catch error then alert error

    # Load the console with a string of CoffeeScript.
    window.loadConsole = (coffee) ->
      $('#repl_source').val coffee
      compileSource()
      $('.navigation.try').addClass('active')
      false

    # Helper to hide the menus.
    closeMenus = ->
      $('.navigation.active').removeClass 'active'

    # Bind navigation buttons to open the menus.
    $('.navigation').click (e) ->
      return if e.target.tagName.toLowerCase() is 'a'
      return false if $(e.target).closest('.repl_wrapper').length
      if $(this).hasClass('active')
        closeMenus()
      else
        closeMenus()
        $(this).addClass 'active'
      false

    # Dismiss console if Escape pressed or click falls outside console
    # Trigger Run button on Ctrl-Enter
    $(document.body)
      .keydown (e) ->
        closeMenus() if e.which == 27
        evalJS() if e.which == 13 and (e.metaKey or e.ctrlKey) and $('.minibutton.run:visible').length
      .click (e) ->
        return false if $(e.target).hasClass('minibutton')
        closeMenus()

    $("#repl_permalink").click (e) ->
        window.location = $(this).attr("href")
        false

    # If source code is included in location.hash, display it.
    hash = decodeURIComponent location.hash.replace(/^#/, '')
    if hash.indexOf(sourceFragment) == 0
        src = hash.substr sourceFragment.length
        loadConsole src

    compileSource()

  </script>

  <script src="javascripts/jquery.js"></script>
  <script src="javascripts/coffee-script.js"></script>
  <script src="extras/mammouth.js"></script>

</body>
</html>